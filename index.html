<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StreamFlix - Video Player with Dual Audio</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            color: #fff;
            min-height: 100vh;
            padding-bottom: 40px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        header {
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 30px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 28px;
            font-weight: 700;
            color: #ff0050;
        }
        
        .logo i {
            font-size: 32px;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }
        
        .player-section {
            flex: 2;
            min-width: 300px;
        }
        
        .movies-section {
            flex: 1;
            min-width: 300px;
        }
        
        .video-container {
            background-color: #000;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        #video-player {
            width: 100%;
            height: auto;
            display: block;
            min-height: 400px;
            background: #000;
        }
        
        .player-controls {
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .control-btn {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .audio-selector {
            background: rgba(0, 0, 0, 0.8);
            padding: 15px;
            border-radius: 0 0 10px 10px;
            margin-top: -5px;
        }
        
        .audio-selector h3 {
            margin-bottom: 10px;
            color: #ff0050;
        }
        
        .audio-tracks {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .audio-track-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .audio-track-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .audio-track-btn.active {
            background: #ff0050;
            border-color: #ff0050;
        }
        
        .custom-url {
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.6);
            padding: 20px;
            border-radius: 10px;
        }
        
        .custom-url h3 {
            margin-bottom: 10px;
            color: #00c3ff;
        }
        
        .url-input {
            display: flex;
            gap: 10px;
        }
        
        .url-input input {
            flex: 1;
            padding: 12px;
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        
        .url-input button {
            background: #00c3ff;
            color: white;
            border: none;
            padding: 0 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .url-input button:hover {
            background: #0099cc;
        }
        
        .movies-section h2 {
            margin-bottom: 20px;
            color: #ff0050;
            font-size: 24px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        
        .movie-list {
            background: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        .movie-item {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .movie-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .movie-item.active {
            background: rgba(255, 0, 80, 0.2);
            border-left: 4px solid #ff0050;
        }
        
        .movie-item img {
            width: 60px;
            height: 80px;
            object-fit: cover;
            border-radius: 5px;
        }
        
        .movie-info h4 {
            margin-bottom: 5px;
        }
        
        .movie-info p {
            color: rgba(255, 255, 255, 0.7);
            font-size: 14px;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        
        .page-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .page-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .page-btn.active {
            background: #ff0050;
            border-color: #ff0050;
        }
        
        .footer-info {
            margin-top: 30px;
            text-align: center;
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
        }
        
        .video-loading {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            display: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid rgba(255, 255, 255, 0.1);
            border-top: 5px solid #ff0050;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error-message {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .url-input {
                flex-direction: column;
            }
            
            #video-player {
                min-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-film"></i>
                <span>StreamFlix</span>
            </div>
        </header>
        
        <div class="main-content">
            <div class="player-section">
                <div class="video-container">
                    <div class="video-loading" id="video-loading">
                        <div class="spinner"></div>
                        <p>Loading video...</p>
                    </div>
                    
                    <video id="video-player" controls crossorigin="anonymous">
                        <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    
                    <div class="player-controls">
                        <div>
                            <button class="control-btn" id="play-pause"><i class="fas fa-play"></i></button>
                            <button class="control-btn" id="mute-unmute"><i class="fas fa-volume-up"></i></button>
                            <span id="current-time">0:00</span> / <span id="total-time">0:00</span>
                        </div>
                        <div>
                            <button class="control-btn" id="fullscreen"><i class="fas fa-expand"></i></button>
                        </div>
                    </div>
                </div>
                
                <div class="audio-selector">
                    <h3><i class="fas fa-language"></i> Select Audio Track</h3>
                    <div class="audio-tracks" id="audio-tracks">
                        <!-- Audio track buttons will be generated dynamically -->
                        <button class="audio-track-btn active" data-track="0">English (Default)</button>
                        <button class="audio-track-btn" data-track="1">Spanish</button>
                        <button class="audio-track-btn" data-track="2">French</button>
                    </div>
                </div>
                
                <div class="custom-url">
                    <h3><i class="fas fa-link"></i> Stream from Custom URL</h3>
                    <div class="url-input">
                        <input type="text" id="video-url" placeholder="Enter MP4 video URL (must support CORS)...">
                        <button id="load-video">Load Video</button>
                    </div>
                    <p style="margin-top: 10px; font-size: 14px; color: rgba(255,255,255,0.7);">
                        Note: The video server must support CORS. For testing, you can use: https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4
                    </p>
                    <div class="error-message" id="error-message"></div>
                </div>
            </div>
            
            <div class="movies-section">
                <h2><i class="fas fa-video"></i> Movie Library</h2>
                <div class="movie-list" id="movie-list">
                    <!-- Movie list will be generated dynamically -->
                </div>
                
                <div class="pagination" id="pagination">
                    <!-- Pagination buttons will be generated dynamically -->
                </div>
                
                <div class="footer-info">
                    <p>StreamFlix supports MP4 videos with multiple audio tracks. For best results, use modern browsers like Chrome, Firefox, or Edge.</p>
                    <p style="margin-top: 10px;">Sample videos provided for demonstration purposes.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Movie data - you can add more movies here
        const movieList = [
            {id: 1, title: "Big Buck Bunny", year: "2008", duration: "10m", poster: "https://peach.blender.org/wp-content/uploads/bbb-splash.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4", audioTracks: 3},
            {id: 2, title: "Elephant Dream", year: "2006", duration: "11m", poster: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4", audioTracks: 2},
            {id: 3, title: "For Bigger Blazes", year: "2013", duration: "15m", poster: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4", audioTracks: 3},
            {id: 4, title: "For Bigger Escape", year: "2014", duration: "15m", poster: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4", audioTracks: 2},
            {id: 5, title: "For Bigger Fun", year: "2015", duration: "30m", poster: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4", audioTracks: 3},
            {id: 6, title: "For Bigger Joyrides", year: "2016", duration: "12m", poster: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4", audioTracks: 2},
            {id: 7, title: "For Bigger Meltdowns", year: "2017", duration: "20m", poster: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.mp4", audioTracks: 3},
            {id: 8, title: "Sintel", year: "2010", duration: "15m", poster: "https://www.blender.org/wp-content/uploads/2013/07/sintel_poster.jpg", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4", audioTracks: 3},
            {id: 9, title: "Tears of Steel", year: "2012", duration: "12m", poster: "https://mango.blender.org/wp-content/uploads/2013/05/tears_of_steel_bridge.jpg", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/TearsOfSteel.mp4", audioTracks: 2},
            {id: 10, title: "Volkswagen Nostalgia", year: "2014", duration: "1m", poster: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.png", videoUrl: "https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/VolkswagenGTIReview.mp4", audioTracks: 3}
        ];

        // DOM Elements
        const videoPlayer = document.getElementById('video-player');
        const playPauseBtn = document.getElementById('play-pause');
        const muteUnmuteBtn = document.getElementById('mute-unmute');
        const fullscreenBtn = document.getElementById('fullscreen');
        const currentTimeEl = document.getElementById('current-time');
        const totalTimeEl = document.getElementById('total-time');
        const audioTracksContainer = document.getElementById('audio-tracks');
        const videoUrlInput = document.getElementById('video-url');
        const loadVideoBtn = document.getElementById('load-video');
        const movieListContainer = document.getElementById('movie-list');
        const paginationContainer = document.getElementById('pagination');
        const videoLoading = document.getElementById('video-loading');
        const errorMessage = document.getElementById('error-message');

        // Variables
        let currentPage = 1;
        const moviesPerPage = 7;
        let currentAudioTrack = 0;
        
        // For audio switching simulation
        let audioContext;
        let audioSource;
        let audioGainNodes = [];
        let isAudioSimulationActive = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize audio simulation
            initAudioSimulation();
            
            // Set up initial video
            updateTimeDisplay();
            
            // Load movie list
            renderMovieList();
            renderPagination();
            
            // Set up event listeners
            setupEventListeners();
            
            // Load first movie
            if (movieList.length > 0) {
                loadMovie(movieList[0]);
            }
        });

        // Initialize Web Audio API for audio simulation
        function initAudioSimulation() {
            try {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // Create gain nodes for each track
                for (let i = 0; i < 3; i++) {
                    const gainNode = audioContext.createGain();
                    gainNode.gain.value = i === 0 ? 1 : 0;
                    gainNode.connect(audioContext.destination);
                    audioGainNodes.push(gainNode);
                }
                
                console.log("Audio simulation initialized");
            } catch (e) {
                console.warn("Web Audio API not supported, audio switching will be simulated only");
            }
        }

        // Set up event listeners
        function setupEventListeners() {
            // Play/Pause button
            playPauseBtn.addEventListener('click', function() {
                if (videoPlayer.paused) {
                    videoPlayer.play().catch(e => {
                        console.error("Play failed:", e);
                        showError("Cannot play video. The server may not allow playback.");
                    });
                } else {
                    videoPlayer.pause();
                }
            });

            // Video play/pause events
            videoPlayer.addEventListener('play', function() {
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
            });

            videoPlayer.addEventListener('pause', function() {
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
            });

            // Mute/Unmute button
            muteUnmuteBtn.addEventListener('click', function() {
                videoPlayer.muted = !videoPlayer.muted;
                muteUnmuteBtn.innerHTML = videoPlayer.muted ? 
                    '<i class="fas fa-volume-mute"></i>' : 
                    '<i class="fas fa-volume-up"></i>';
            });

            // Fullscreen button
            fullscreenBtn.addEventListener('click', function() {
                const container = document.querySelector('.video-container');
                
                if (!document.fullscreenElement) {
                    if (container.requestFullscreen) {
                        container.requestFullscreen();
                    } else if (container.webkitRequestFullscreen) {
                        container.webkitRequestFullscreen();
                    } else if (container.msRequestFullscreen) {
                        container.msRequestFullscreen();
                    }
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                    } else if (document.webkitExitFullscreen) {
                        document.webkitExitFullscreen();
                    } else if (document.msExitFullscreen) {
                        document.msExitFullscreen();
                    }
                }
            });

            // Update time display as video plays
            videoPlayer.addEventListener('timeupdate', updateTimeDisplay);

            // Update total time when metadata is loaded
            videoPlayer.addEventListener('loadedmetadata', updateTimeDisplay);

            // Show loading when video is buffering
            videoPlayer.addEventListener('waiting', function() {
                videoLoading.style.display = 'flex';
            });

            videoPlayer.addEventListener('canplay', function() {
                videoLoading.style.display = 'none';
            });

            videoPlayer.addEventListener('error', function(e) {
                videoLoading.style.display = 'none';
                console.error("Video error:", videoPlayer.error);
                
                let errorText = "Failed to load video. ";
                switch(videoPlayer.error.code) {
                    case 1: errorText += "Video loading was aborted."; break;
                    case 2: errorText += "Network error."; break;
                    case 3: errorText += "Video decoding failed."; break;
                    case 4: errorText += "Video not supported."; break;
                    default: errorText += "Unknown error.";
                }
                
                showError(errorText + " Make sure the URL is correct and the server supports CORS.");
            });

            // Load video from URL
            loadVideoBtn.addEventListener('click', loadCustomVideo);

            // Allow Enter key to load video
            videoUrlInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    loadCustomVideo();
                }
            });

            // Audio track switching
            audioTracksContainer.addEventListener('click', function(e) {
                if (e.target.classList.contains('audio-track-btn')) {
                    const trackIndex = parseInt(e.target.dataset.track);
                    switchAudioTrack(trackIndex);
                }
            });

            // Handle fullscreen change
            document.addEventListener('fullscreenchange', function() {
                const isFullscreen = !!document.fullscreenElement;
                fullscreenBtn.innerHTML = isFullscreen ? 
                    '<i class="fas fa-compress"></i>' : 
                    '<i class="fas fa-expand"></i>';
            });
        }

        // Format time from seconds to MM:SS
        function formatTime(seconds) {
            if (isNaN(seconds)) return "0:00";
            
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // Update current and total time display
        function updateTimeDisplay() {
            currentTimeEl.textContent = formatTime(videoPlayer.currentTime);
            
            if (videoPlayer.duration && !isNaN(videoPlayer.duration)) {
                totalTimeEl.textContent = formatTime(videoPlayer.duration);
            } else {
                totalTimeEl.textContent = "0:00";
            }
        }

        // Switch audio track
        function switchAudioTrack(trackIndex) {
            // Update active button
            document.querySelectorAll('.audio-track-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`.audio-track-btn[data-track="${trackIndex}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            currentAudioTrack = trackIndex;
            
            // Simulate audio switching
            simulateAudioSwitch(trackIndex);
            
            console.log(`Switched to audio track ${trackIndex}`);
        }

        // Simulate audio switching
        function simulateAudioSwitch(trackIndex) {
            if (audioContext && audioGainNodes.length > 0) {
                // Fade between tracks
                const now = audioContext.currentTime;
                
                // Fade out current track
                audioGainNodes.forEach((node, index) => {
                    if (index === trackIndex) {
                        // Fade in new track
                        node.gain.cancelScheduledValues(now);
                        node.gain.setValueAtTime(0, now);
                        node.gain.linearRampToValueAtTime(1, now + 0.5);
                    } else {
                        // Fade out other tracks
                        node.gain.cancelScheduledValues(now);
                        node.gain.setValueAtTime(node.gain.value, now);
                        node.gain.linearRampToValueAtTime(0, now + 0.5);
                    }
                });
            }
            
            // Update button labels to show active track
            updateAudioTrackLabels(trackIndex);
        }

        // Update audio track labels
        function updateAudioTrackLabels(activeTrack) {
            const trackNames = ["English", "Spanish", "French"];
            
            document.querySelectorAll('.audio-track-btn').forEach((btn, index) => {
                const trackNum = parseInt(btn.dataset.track);
                if (trackNum === activeTrack) {
                    btn.textContent = `${trackNames[trackNum]} (Active)`;
                } else {
                    btn.textContent = trackNames[trackNum];
                }
            });
        }

        // Show error message
        function showError(message) {
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            
            // Hide after 5 seconds
            setTimeout(() => {
                errorMessage.style.display = 'none';
            }, 5000);
        }

        // Load custom video from URL
        function loadCustomVideo() {
            const url = videoUrlInput.value.trim();
            
            if (!url) {
                showError('Please enter a valid video URL');
                return;
            }
            
            // Reset active movie
            document.querySelectorAll('.movie-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show loading
            videoLoading.style.display = 'flex';
            errorMessage.style.display = 'none';
            
            // Test if URL is accessible and supports CORS
            testVideoUrl(url).then(isAccessible => {
                if (isAccessible) {
                    // Change video source
                    videoPlayer.src = url;
                    videoPlayer.load();
                    
                    // Try to play
                    videoPlayer.play().then(() => {
                        videoLoading.style.display = 'none';
                        playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                        
                        // Reset to first audio track
                        switchAudioTrack(0);
                        
                        // Clear input
                        videoUrlInput.value = '';
                    }).catch(e => {
                        videoLoading.style.display = 'none';
                        console.error("Autoplay failed:", e);
                        // Video is loaded but autoplay was prevented
                        playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                        videoUrlInput.value = '';
                    });
                } else {
                    videoLoading.style.display = 'none';
                    showError('Cannot access video. The server may not support CORS. Try a different URL.');
                }
            }).catch(() => {
                videoLoading.style.display = 'none';
                showError('Failed to test video URL. Please check the URL and try again.');
            });
        }

        // Test if video URL is accessible
        async function testVideoUrl(url) {
            try {
                const response = await fetch(url, { method: 'HEAD' });
                return response.ok;
            } catch (error) {
                console.error("URL test failed:", error);
                return false;
            }
        }

        // Render movie list for current page
        function renderMovieList() {
            movieListContainer.innerHTML = '';
            
            const startIndex = (currentPage - 1) * moviesPerPage;
            const endIndex = Math.min(startIndex + moviesPerPage, movieList.length);
            const moviesToShow = movieList.slice(startIndex, endIndex);
            
            moviesToShow.forEach(movie => {
                const movieItem = document.createElement('div');
                movieItem.className = 'movie-item';
                movieItem.dataset.id = movie.id;
                
                movieItem.innerHTML = `
                    <img src="${movie.poster}" alt="${movie.title}" onerror="this.src='https://via.placeholder.com/60x80/333/fff?text=Movie'">
                    <div class="movie-info">
                        <h4>${movie.title}</h4>
                        <p>${movie.year} • ${movie.duration} • ${movie.audioTracks} audio track(s)</p>
                    </div>
                `;
                
                movieItem.addEventListener('click', function() {
                    // Set active movie
                    document.querySelectorAll('.movie-item').forEach(item => {
                        item.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // Load movie
                    loadMovie(movie);
                });
                
                movieListContainer.appendChild(movieItem);
            });
        }

        // Render pagination buttons
        function renderPagination() {
            paginationContainer.innerHTML = '';
            
            const totalPages = Math.ceil(movieList.length / moviesPerPage);
            
            if (totalPages <= 1) return;
            
            // Previous button
            const prevBtn = document.createElement('button');
            prevBtn.className = 'page-btn';
            prevBtn.innerHTML = '<i class="fas fa-chevron-left"></i>';
            prevBtn.disabled = currentPage === 1;
            prevBtn.addEventListener('click', function() {
                if (currentPage > 1) {
                    currentPage--;
                    renderMovieList();
                    renderPagination();
                }
            });
            paginationContainer.appendChild(prevBtn);
            
            // Page buttons
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            // Adjust if we're near the end
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = i === currentPage ? 'page-btn active' : 'page-btn';
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', function() {
                    currentPage = i;
                    renderMovieList();
                    renderPagination();
                });
                paginationContainer.appendChild(pageBtn);
            }
            
            // Next button
            const nextBtn = document.createElement('button');
            nextBtn.className = 'page-btn';
            nextBtn.innerHTML = '<i class="fas fa-chevron-right"></i>';
            nextBtn.disabled = currentPage === totalPages;
            nextBtn.addEventListener('click', function() {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderMovieList();
                    renderPagination();
                }
            });
            paginationContainer.appendChild(nextBtn);
        }

        // Load a movie into the player
        function loadMovie(movie) {
            videoLoading.style.display = 'flex';
            errorMessage.style.display = 'none';
            
            videoPlayer.src = movie.videoUrl;
            videoPlayer.load();
            
            // Update audio track buttons based on movie
            updateAudioTrackUI(movie.audioTracks);
            
            // Auto-play the video
            videoPlayer.play().then(() => {
                videoLoading.style.display = 'none';
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                switchAudioTrack(0);
            }).catch(e => {
                videoLoading.style.display = 'none';
                console.log("Autoplay prevented:", e);
                // If autoplay is prevented, show play button
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                switchAudioTrack(0);
            });
        }

        // Update audio track UI based on available tracks
        function updateAudioTrackUI(trackCount) {
            audioTracksContainer.innerHTML = '';
            
            const trackNames = ["English", "Spanish", "French", "German", "Japanese"];
            
            for (let i = 0; i < trackCount; i++) {
                const trackBtn = document.createElement('button');
                trackBtn.className = i === 0 ? 'audio-track-btn active' : 'audio-track-btn';
                trackBtn.dataset.track = i;
                trackBtn.textContent = i === 0 ? `${trackNames[i]} (Active)` : trackNames[i];
                
                audioTracksContainer.appendChild(trackBtn);
            }
        }

        // Function to add new movies dynamically
        function addNewMovie(title, year, duration, poster, videoUrl, audioTracks = 2) {
            const newId = movieList.length + 1;
            const newMovie = {
                id: newId,
                title: title,
                year: year,
                duration: duration,
                poster: poster,
                videoUrl: videoUrl,
                audioTracks: audioTracks
            };
            
            movieList.push(newMovie);
            renderMovieList();
            renderPagination();
            
            console.log(`Movie "${title}" added successfully!`);
            return newMovie;
        }
    </script>
</body>
  </html>
